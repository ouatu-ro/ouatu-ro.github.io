---
import type { ProjectRecord } from "../../lib/projects";

interface Props {
  project: ProjectRecord;
}

const { project } = Astro.props as Props;
const codeLines = createCodeLines(project);

function createCodeLines(project: ProjectRecord) {
  const pascalName = toPascalName(project);
  return [
    `export function ${pascalName}() {`,
    `  const app = initTool({ name: "${project.name}" });`,
    "  return app.run();",
    "}",
  ];
}

function toPascalName(project: ProjectRecord) {
  const source = project.slug || project.name || "";
  return source
    .toLowerCase()
    .replace(/[^a-z0-9]+/g, " ")
    .trim()
    .split(" ")
    .filter(Boolean)
    .map((segment) => segment[0].toUpperCase() + segment.slice(1))
    .join("");
}
---

<div class="code-lines">
  {
    codeLines.map((line, idx) => (
      <span class="code-line" data-line-index={idx}>
        {line}
      </span>
    ))
  }
</div>

<style>
  :global(.project-card-media--code) {
    background: linear-gradient(
      140deg,
      rgba(25, 25, 60, 0.9),
      rgba(15, 15, 30, 0.95)
    );
    font-family: "Source Code Pro", "Fira Code", monospace;
  }

  .code-lines {
    width: 86%;
    display: grid;
    gap: 0.42rem;
  }

  .code-line {
    font-size: 0.86rem;
    color: rgba(173, 215, 255, 0.9);
  }
</style>
